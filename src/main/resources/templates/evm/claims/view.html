<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
    th:replace="~{layout :: html(content=~{::content}, pageTitle='Chi tiết bảo lãnh')}">

<body>
    <div th:fragment="content">
        <div class="card mb-3">
            <div class="card-header">
                <h3 class="card-title"><i class="fas fa-file-invoice"></i> <span
                        th:text="${claim.claimNumber}">WC123</span></h3>
                <span class="badge" th:classappend="${'status-' + claim.status.name().toLowerCase().replace('_', '-')}"
                    th:text="${claim.status}">Status</span>
            </div>

            <div class="form-row">
                <div class="form-group"><label>Xe</label>
                    <div th:text="${claim.vehicle.vin + ' - ' + claim.vehicle.make + ' ' + claim.vehicle.model}">Vehicle
                    </div>
                </div>
                <div class="form-group"><label>Trung tâm dịch vụ</label>
                    <div th:text="${claim.serviceCenter ?: 'N/A'}">SC</div>
                </div>
            </div>

            <div class="form-group"><label>Mô tả lỗi</label>
                <div th:text="${claim.failureDescription}">Description</div>
            </div>
            <div class="form-group" th:if="${claim.diagnosisNotes}"><label>Ghi chú chẩn đoán</label>
                <div th:text="${claim.diagnosisNotes}">Notes</div>
            </div>

            <div class="form-row">
                <div class="form-group"><label>Số ODO</label>
                    <div th:text="${claim.mileageAtClaim ?: 'N/A'}">Miles</div>
                </div>
                <div class="form-group"><label>Giờ công</label>
                    <div th:text="${claim.laborHours ?: 'N/A'}">Hours</div>
                </div>
            </div>
        </div>

        <!-- Approve/Reject Actions -->
        <div class="card mb-3" th:if="${claim.status.name() == 'SUBMITTED' or claim.status.name() == 'UNDER_REVIEW'}">
            <div class="card-header">
                <h3 class="card-title">Quyết định phê duyệt</h3>
            </div>
            <div class="d-flex gap-2" style="flex-wrap: wrap;">
                <form th:action="@{/evm/claims/{id}/approve(id=${claim.id})}" method="post">
                    <button type="submit" class="btn btn-success"><i class="fas fa-check"></i> Duyệt yêu cầu</button>
                </form>
                <form th:action="@{/evm/claims/{id}/reject(id=${claim.id})}" method="post" class="d-flex gap-1">
                    <input type="text" name="rejectionReason" class="form-control" style="width: 300px;"
                        placeholder="Lý do từ chối..." required>
                    <button type="submit" class="btn btn-danger"><i class="fas fa-times"></i> Từ chối</button>
                </form>
            </div>
        </div>

        <a th:href="@{/evm/claims}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Quay lại</a>
    </div>
</body>

</html>