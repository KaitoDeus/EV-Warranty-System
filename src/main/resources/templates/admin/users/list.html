<!doctype html>
<html
  xmlns:th="http://www.thymeleaf.org"
  th:replace="~{layout :: html(content=~{::content}, pageTitle='Quản lý người dùng')}"
>
  <body>
    <div th:fragment="content">
      <div class="d-flex justify-between align-center mb-3">
        <form th:action="@{/admin/users}" method="get" class="search-bar">
          <input
            type="text"
            name="search"
            th:value="${search}"
            class="form-control"
            placeholder="Tìm kiếm người dùng..."
          />
          <button type="submit" class="btn btn-secondary">
            <i class="fas fa-search"></i> Tìm kiếm
          </button>
        </form>
        <a th:href="@{/admin/users/new}" class="btn btn-primary"
          ><i class="fas fa-plus"></i> Thêm người dùng</a
        >
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Tên đăng nhập</th>
              <th>Họ và tên</th>
              <th>Email</th>
              <th>Vai trò</th>
              <th>Trung tâm dịch vụ</th>
              <th>Trạng thái</th>
              <th>Thao tác</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="user : ${users.content}">
              <td>
                <a
                  th:href="@{/admin/users/{id}(id=${user.id})}"
                  th:text="${user.username}"
                  >user</a
                >
              </td>
              <td th:text="${user.fullName}">Name</td>
              <td th:text="${user.email}">email@example.com</td>
              <td>
                <span
                  th:each="role : ${user.roles}"
                  class="badge badge-primary"
                  style="margin-right: 4px"
                  th:text="${role.name}"
                  >ROLE</span
                >
              </td>
              <td th:text="${user.serviceCenter ?: 'N/A'}">SC</td>
              <td>
                <span th:if="${user.active}" class="badge badge-success"
                  >Hoạt động</span
                ><span th:unless="${user.active}" class="badge badge-secondary"
                  >Đã khóa</span
                >
              </td>
              <td class="btn-group">
                <a
                  th:href="@{/admin/users/{id}/edit(id=${user.id})}"
                  class="btn btn-sm btn-secondary"
                  title="Sửa"
                  ><i class="fas fa-edit"></i
                ></a>
                <form
                  th:action="@{/admin/users/{id}/toggle(id=${user.id})}"
                  method="post"
                  style="display: inline"
                >
                  <button class="btn btn-sm btn-secondary" title="Khóa/Mở khóa">
                    <i class="fas fa-power-off"></i>
                  </button>
                </form>
                <form
                  th:action="@{/admin/users/{id}/delete(id=${user.id})}"
                  method="post"
                  style="display: inline"
                  onsubmit="
                    return confirm('Bạn có chắc chắn muốn xóa người dùng này?');
                  "
                >
                  <button class="btn btn-sm btn-danger" title="Xóa">
                    <i class="fas fa-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
