<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: html(content=~{::content}, pageTitle='Inventory')}">

<body>
    <div th:fragment="content">
        <!-- Low Stock Alert -->
        <div th:if="${!lowStockItems.isEmpty()}" class="alert alert-warning mb-3">
            <i class="fas fa-exclamation-triangle"></i>
            <span th:text="${lowStockItems.size() + ' item(s) are running low on stock!'}">Low stock items</span>
        </div>

        <!-- Add Stock Form -->
        <div class="card mb-3">
            <div class="card-header">
                <h3 class="card-title">Add Stock</h3>
            </div>
            <form th:action="@{/sc/inventory/add}" method="post" class="d-flex gap-2 align-center"
                style="flex-wrap: wrap;">
                <select name="partId" class="form-control" style="width: auto; min-width: 200px;" required>
                    <option value="">Select Part</option>
                    <option th:each="part : ${parts}" th:value="${part.id}"
                        th:text="${part.partNumber + ' - ' + part.name}">Part</option>
                </select>
                <input type="number" name="quantity" class="form-control" style="width: 120px;" min="1" value="1"
                    placeholder="Qty" required>
                <button type="submit" class="btn btn-primary"><i class="fas fa-plus"></i> Add</button>
            </form>
        </div>

        <!-- Inventory Table -->
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Part</th>
                        <th>Part #</th>
                        <th>On Hand</th>
                        <th>Reserved</th>
                        <th>Available</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="item : ${inventory}">
                        <td th:text="${item.part.name}">Part Name</td>
                        <td th:text="${item.part.partNumber}">PN123</td>
                        <td th:text="${item.quantityOnHand}">10</td>
                        <td th:text="${item.quantityReserved}">2</td>
                        <td th:text="${item.availableQuantity}">8</td>
                        <td>
                            <span th:if="${item.needsReorder()}" class="badge badge-danger">Low Stock</span>
                            <span th:unless="${item.needsReorder()}" class="badge badge-success">OK</span>
                        </td>
                        <td>
                            <form th:action="@{/sc/inventory/{id}/adjust(id=${item.id})}" method="post"
                                class="d-flex gap-1">
                                <input type="number" name="adjustment" class="form-control" style="width: 80px;"
                                    placeholder="Â±">
                                <button type="submit" class="btn btn-sm btn-secondary">Adjust</button>
                            </form>
                        </td>
                    </tr>
                    <tr th:if="${inventory.isEmpty()}">
                        <td colspan="7" class="text-center text-muted">No inventory items</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>